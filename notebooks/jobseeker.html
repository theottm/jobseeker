<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-10-05 ven. 17:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="teddd" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge4a003b">1. Explorer</a>
<ul>
<li><a href="#orgc0088ae">1.1. Imports</a>
<ul>
<li><a href="#org31350b9">1.1.1. ipython</a></li>
<li><a href="#orgac6eefe">1.1.2. pandas</a></li>
</ul>
</li>
<li><a href="#org62c5a3d">1.2. Data load</a>
<ul>
<li><a href="#orgfa5a421">1.2.1. load everything</a></li>
<li><a href="#org5516058">1.2.2. rename</a></li>
<li><a href="#orgb12d7fe">1.2.3. python example&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></a></li>
<li><a href="#orgd549e44">1.2.4. org doc elisp example&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></a></li>
<li><a href="#org0417cef">1.2.5. python&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span></span></a></li>
</ul>
</li>
<li><a href="#org23fc1aa">1.3. Cleansing / Formating&#xa0;&#xa0;&#xa0;<span class="tag"><span class="clean">clean</span></span></a>
<ul>
<li><a href="#orged87a99">1.3.1. duplicates</a></li>
<li><a href="#orgf93c2b4">1.3.2. olders</a></li>
<li><a href="#orgca2fa68">1.3.3. string numbers to integers</a></li>
<li><a href="#org58f8d57">1.3.4. drop erratic values</a></li>
<li><a href="#orgfe9f0eb">1.3.5. rename</a></li>
</ul>
</li>
<li><a href="#orge274301">1.4. Filtering</a>
<ul>
<li><a href="#orga49babf">1.4.1. Look for 1 keywords</a></li>
<li><a href="#org0196424">1.4.2. Queries</a></li>
<li><a href="#org0ce5cb5">1.4.3. Look for multiple keywords</a></li>
<li><a href="#org5d13fa6">1.4.4. companies</a></li>
</ul>
</li>
<li><a href="#orga8dd65c">1.5. Stats</a>
<ul>
<li><a href="#orgefdc823">1.5.1. overview</a></li>
<li><a href="#org7d862b5">1.5.2. days ago</a></li>
</ul>
</li>
<li><a href="#org9d77690">1.6. Printing</a>
<ul>
<li><a href="#org0b2df89">1.6.1. quick overview</a></li>
<li><a href="#org81993ed">1.6.2. html pages</a></li>
<li><a href="#orgd8c4276">1.6.3. server</a></li>
<li><a href="#orgc53936c">1.6.4. org  table (python)&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span></span></a></li>
<li><a href="#org737768f">1.6.5. org results: html&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></a></li>
<li><a href="#org030954f">1.6.6. soupprint</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga72d20a">2. External Documentation</a>
<ul>
<li><a href="#org3b2afcd">2.1. doc : look for matching patern&#xa0;&#xa0;&#xa0;<span class="tag"><span class="doc">doc</span></span></a></li>
<li><a href="#org6c8455f">2.2. pandas</a></li>
</ul>
</li>
<li><a href="#org39df398">3. Tests</a>
<ul>
<li><a href="#orgd17e283">3.1. ob-ipython</a>
<ul>
<li><a href="#orgf5d96a1">3.1.1. hands-on tryout</a></li>
<li><a href="#org845f7d3">3.1.2. doc tutorial</a></li>
<li><a href="#org445b9a4">3.1.3. other tryouts</a></li>
</ul>
</li>
<li><a href="#orgc5dfe43">3.2. nltk</a>
<ul>
<li><a href="#org479261f">3.2.1. text selection</a></li>
<li><a href="#orgfcc920f">3.2.2. search</a></li>
<li><a href="#org1c05c7a">3.2.3. generation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></a></li>
<li><a href="#org2adce2a">3.2.4. normalizing</a></li>
<li><a href="#orgb9e75d1">3.2.5. vocabulary</a></li>
<li><a href="#org27008b3">3.2.6. <span class="todo TODO">TODO</span> Build a corpus !</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orge4a003b" class="outline-2">
<h2 id="orge4a003b"><span class="section-number-2">1</span> Explorer</h2>
<div class="outline-text-2" id="text-1">
<p>
Proper program.
</p>
</div>
<div id="outline-container-orgc0088ae" class="outline-3">
<h3 id="orgc0088ae"><span class="section-number-3">1.1</span> Imports</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-org31350b9" class="outline-4">
<h4 id="org31350b9"><span class="section-number-4">1.1.1</span> ipython</h4>
<div class="outline-text-4" id="text-1-1-1">
<div class="org-src-container">
<pre class="src src-ipython">%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
</pre>
</div>
</div>
</div>
<div id="outline-container-orgac6eefe" class="outline-4">
<h4 id="orgac6eefe"><span class="section-number-4">1.1.2</span> pandas</h4>
<div class="outline-text-4" id="text-1-1-2">
<div class="org-src-container">
<pre class="src src-ipython">import pandas as pd    
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org62c5a3d" class="outline-3">
<h3 id="org62c5a3d"><span class="section-number-3">1.2</span> Data load</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-orgfa5a421" class="outline-4">
<h4 id="orgfa5a421"><span class="section-number-4">1.2.1</span> load everything</h4>
<div class="outline-text-4" id="text-1-2-1">
</div>
<ol class="org-ol">
<li><a id="orgcaa8f9e"></a>file list with path<br />
<div class="outline-text-5" id="text-1-2-1-1">
<div class="org-src-container">
<pre class="src src-ipython">import os
csv_files = []
date = "2018-09-30"
for dirpath, dirs, files in os.walk("../data/raw/" + date): 
  for filename in files:
    fname = os.path.join(dirpath,filename)
    if fname.endswith('.csv'):
      csv_files.append(fname)
</pre>
</div>
</div>
</li>
<li><a id="org1f77aaf"></a>dataframe creation<br />
<div class="outline-text-5" id="text-1-2-1-2">
<div class="org-src-container">
<pre class="src src-ipython">jobs = pd.DataFrame()

for fl in csv_files:
    print(fl+(30-len(fl)//2)*" *")
    try:
	jobs_set = pd.read_csv(fl)
	jobs_set.dropna(axis=0, how='any', subset=["desc"], inplace=True)
	jobs_set.drop_duplicates(subset="desc", inplace=True)            
	try:                                                             
	    jobs.iloc[0,0]                                               
	    jobs = jobs.append(jobs_set)                                 
	except IndexError:                                               
	    jobs = jobs_set                                              
    except pd.errors.EmptyDataError:
	pass
</pre>
</div>
</div>
</li>

<li><a id="orge753367"></a><span class="todo TODO">TODO</span> time range selection<br /></li>
</ol>
</div>
<div id="outline-container-org5516058" class="outline-4">
<h4 id="org5516058"><span class="section-number-4">1.2.2</span> rename</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
use to quickly reset original df
</p>
<div class="org-src-container">
<pre class="src src-ipython">df = jobs
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb12d7fe" class="outline-4">
<h4 id="orgb12d7fe"><span class="section-number-4">1.2.3</span> python example&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></h4>
<div class="outline-text-4" id="text-1-2-3">
<div class="org-src-container">
<pre class="src src-python" id="org06f099f"><span style="font-weight: bold; font-style: italic;">x</span> = 12
<span style="font-weight: bold;">return</span> x
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">return</span> <span style="font-weight: bold;">int</span>(x)+1
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd549e44" class="outline-4">
<h4 id="orgd549e44"><span class="section-number-4">1.2.4</span> org doc elisp example&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></h4>
<div class="outline-text-4" id="text-1-2-4">
<table id="org26adf7f" border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">4</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org0417cef" class="outline-4">
<h4 id="org0417cef"><span class="section-number-4">1.2.5</span> python&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span></span></h4>
<div class="outline-text-4" id="text-1-2-5">
<div class="org-src-container">
<pre class="src src-python" id="orgb9b1960"><span style="font-style: italic;">"~/data/projects/jobseeker/data/raw/18-09-07/dsp.csv"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org38baaab"><span style="font-style: italic;">"~/data/projects/jobseeker/data/raw/18-09-07/dsp.csv"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org5b7d935"><span style="font-style: italic;">"~/data/projects/jobseeker/data/raw/18-09-07/python.csv"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="orgb2b2555"><span style="font-style: italic;">"~/data/projects/jobseeker/data/raw/18-09-07/data scientist.csv"</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python" id="org25e965d"><span style="font-style: italic;">"~/data/projects/jobseeker/data/raw/18-09-07/software engineer.csv"</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org23fc1aa" class="outline-3">
<h3 id="org23fc1aa"><span class="section-number-3">1.3</span> Cleansing / Formating&#xa0;&#xa0;&#xa0;<span class="tag"><span class="clean">clean</span></span></h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orged87a99" class="outline-4">
<h4 id="orged87a99"><span class="section-number-4">1.3.1</span> duplicates</h4>
<div class="outline-text-4" id="text-1-3-1">
</div>
<ol class="org-ol">
<li><a id="org6fa9e51"></a>drop<sub>duplicates</sub><br />
<div class="outline-text-5" id="text-1-3-1-1">
<div class="org-src-container">
<pre class="src src-ipython">df.drop_duplicates(subset="desc", inplace=True)
</pre>
</div>
</div>
</li>

<li><a id="orgb0c1e9d"></a>count<br />
<div class="outline-text-5" id="text-1-3-1-2">
<div class="org-src-container">
<pre class="src src-ipython">df.title.count()
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgf93c2b4" class="outline-4">
<h4 id="orgf93c2b4"><span class="section-number-4">1.3.2</span> olders</h4>
<div class="outline-text-4" id="text-1-3-2">
</div>
<ol class="org-ol">
<li><a id="org1c482bd"></a>map lambda&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<div class="outline-text-5" id="text-1-3-2-1">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.days_ago.str.contains("30+").map(lambda x: not x)]
</pre>
</div>
</div>
</li>

<li><a id="org5adc6c7"></a>==False<br />
<div class="outline-text-5" id="text-1-3-2-2">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.days_ago.str.contains("30+")==False]
</pre>
</div>
</div>
</li>

<li><a id="org9f93e27"></a>count<br />
<div class="outline-text-5" id="text-1-3-2-3">
<div class="org-src-container">
<pre class="src src-ipython">len(df)
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-orgca2fa68" class="outline-4">
<h4 id="orgca2fa68"><span class="section-number-4">1.3.3</span> string numbers to integers</h4>
<div class="outline-text-4" id="text-1-3-3">
<div class="org-src-container">
<pre class="src src-ipython">df["days_ago"] = df.days_ago.apply(lambda x: int(x))
</pre>
</div>
</div>
</div>
<div id="outline-container-org58f8d57" class="outline-4">
<h4 id="org58f8d57"><span class="section-number-4">1.3.4</span> drop erratic values</h4>
<div class="outline-text-4" id="text-1-3-4">
</div>
<ol class="org-ol">
<li><a id="org8a18c51"></a>run<br />
<div class="outline-text-5" id="text-1-3-4-1">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.days_ago.lt(30)]
</pre>
</div>
</div>
</li>
<li><a id="orgdeb01aa"></a>tests<br />
<div class="outline-text-5" id="text-1-3-4-2">
<div class="org-src-container">
<pre class="src src-ipython">df.days_ago.lt(30)
</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgfe9f0eb" class="outline-4">
<h4 id="orgfe9f0eb"><span class="section-number-4">1.3.5</span> rename</h4>
<div class="outline-text-4" id="text-1-3-5">
<div class="org-src-container">
<pre class="src src-ipython">df_clean = df
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge274301" class="outline-3">
<h3 id="orge274301"><span class="section-number-3">1.4</span> Filtering</h3>
<div class="outline-text-3" id="text-1-4">
</div>
<div id="outline-container-orga49babf" class="outline-4">
<h4 id="orga49babf"><span class="section-number-4">1.4.1</span> Look for 1 keywords</h4>
<div class="outline-text-4" id="text-1-4-1">
</div>
<ol class="org-ol">
<li><a id="orge3d6740"></a>keyword definiton<br />
<ol class="org-ol">
<li><a id="org2ccf426"></a>org variable<br />
<div class="outline-text-6" id="text-1-4-1-1-1">
<div class="org-src-container">
<pre class="src src-python" id="org112ac4c"><span style="font-style: italic;">"kunst und medien"</span>
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="orgbe0e06d"></a>look in title<br />
<ol class="org-ol">
<li><a id="orgbf4f29e"></a>boolean serie construction&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<div class="outline-text-6" id="text-1-4-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">df.title.str.contains(k, case=False)
</pre>
</div>
</div>
</li>

<li><a id="orge529561"></a>reduction of our dataset<br />
<div class="outline-text-6" id="text-1-4-1-2-2">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.title.str.contains(k, case=False, na=False)]
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="org31f0677"></a>look in description<br />
<div class="outline-text-5" id="text-1-4-1-3">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.desc.str.contains(k, case=False, na=False)]
</pre>
</div>
</div>
</li>

<li><a id="org5728122"></a><span class="todo TODO">TODO</span> test<br />
<div class="outline-text-5" id="text-1-4-1-4">
<p>
goto Johnny Kitchin
</p>
<div class="org-src-container">
<pre class="src src-ipython">k
</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org0196424" class="outline-4">
<h4 id="org0196424"><span class="section-number-4">1.4.2</span> Queries</h4>
<div class="outline-text-4" id="text-1-4-2">
</div>
<ol class="org-ol">
<li><a id="org31c465b"></a>get queries metadata<br />
<ol class="org-ol">
<li><a id="org277a1a7"></a>dataframe using os results<br />
<div class="outline-text-6" id="text-1-4-2-1-1">
<div class="org-src-container">
<pre class="src src-ipython">import os
queries_name = []
queries_size = []
queries_path = []
queries_time = []
for dirpath, dirs, files in os.walk("../data/raw"): 
  for filename in files:
    if filename.endswith('.csv'):

      path = os.path.join(dirpath, filename)
      queries_path.append(path)

      size = os.path.getsize(path)
      queries_size.append(size)

      fname = filename.replace(".csv", "")
      queries_name.append(fname)

      time = os.path.getmtime(path)
      queries_time.append(time)

queries = pd.DataFrame({"name" : queries_name, "path" : queries_path, "size" : queries_size, "time" : queries_time})      
</pre>
</div>
</div>
</li>
<li><a id="org1fcb2f1"></a>remove oldests results<br />
<ol class="org-ol">
<li><a id="org2e1988d"></a>datetime time format<br />
<div class="outline-text-7" id="text-1-4-2-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">from datetime import datetime
queries["time"] = queries.time.apply(datetime.fromtimestamp)
</pre>
</div>
</div>
</li>

<li><a id="orgf9769dc"></a>y-m-d format time<br />
<div class="outline-text-7" id="text-1-4-2-1-2-2">
<div class="org-src-container">
<pre class="src src-ipython">def format_time(x):
    y = x.strftime("%Y-%m-%d")
    return y

queries["time_formated"] = queries.time.apply(format_time)
</pre>
</div>
</div>
</li>
</ol>
</li>
<li><a id="orgcda4284"></a>remove null size results<br />
<div class="outline-text-6" id="text-1-4-2-1-3">
<div class="org-src-container">
<pre class="src src-ipython">queries_null = queries[queries["size"] &lt; 1]
queries = queries[queries["size"] &gt; 1]
</pre>
</div>
</div>
</li>
<li><a id="orge743865"></a>number of entries in csv file<br />
<ol class="org-ol">
<li><a id="orgff340b8"></a>read as pandas dataframe<br />
<div class="outline-text-7" id="text-1-4-2-1-4-1">
<div class="org-src-container">
<pre class="src src-ipython">def entries_count(csv):
    return len(pd.read_csv(csv))

queries["entries"] = queries.path.apply(entries_count)
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="org8b1948d"></a>inspection<br />
<div class="outline-text-6" id="text-1-4-2-1-5">
<div class="org-src-container">
<pre class="src src-ipython">import humanize
queries["size_for_humans"] = queries["size"].apply(humanize.naturalsize)
queries.sort_values("size", ascending=False)[["name", "size_for_humans", "entries"]].reset_index()
</pre>
</div>
</div>
</li>

<li><a id="org6b655d4"></a>time evolution<br /></li>
<li><a id="org21229b6"></a>return list for next scraper launch<br />
<ol class="org-ol">
<li><a id="orgeb4efcb"></a>remove null size results before (or not)<br />
<div class="outline-text-7" id="text-1-4-2-1-7-1">
<div class="org-src-container">
<pre class="src src-ipython">queries_list = list(set(queries.name))
</pre>
</div>
</div>
</li>
<li><a id="org31c44b9"></a>save in a file for editing<br />
<div class="outline-text-7" id="text-1-4-2-1-7-2">
<div class="org-src-container">
<pre class="src src-ipython">with open("/queries/queries.txt", "w") as f:
    for query in queries_list:
	f.write(query + "\n")
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li><a id="org88f3fb8"></a>launch scraper with the list<br />
<ol class="org-ol">
<li><a id="org93fc0e4"></a>get list from file<br />
<div class="outline-text-6" id="text-1-4-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">with open("queries/best.txt", "r") as f:
    queries_selected = f.read()
    queries_selected = queries_selected.splitlines()
</pre>
</div>
</div>
</li>

<li><a id="orgf73932e"></a>run shell script as subprocess<br />
<ol class="org-ol">
<li><a id="org053c570"></a>variables and imports<br />
<div class="outline-text-7" id="text-1-4-2-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">import subprocess
from subprocess import Popen, PIPE
import shlex

cwd = '/home/teddd/data/projects/jobseeker/data/external/indeed/'
bash_script = [cwd + 'local_crawler_launch.sh']
arguments = queries_selected
command = bash_script + arguments
</pre>
</div>
</div>
</li>

<li><a id="orgc09102c"></a>execution<br />
<ol class="org-ol">
<li><a id="org77486aa"></a>stdout to buffer<br />
<div class="outline-text-8" id="text-1-4-2-2-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">session = subprocess.Popen(command, stdout=PIPE, stderr=PIPE)
stdout, stderr = session.communicate()

if stderr:
    raise Exception("Error "+str(stderr))

stdout
</pre>
</div>
</div>
</li>

<li><a id="org82da6e3"></a>stdout to file<br />
<div class="outline-text-8" id="text-1-4-2-2-2-2-2">
<div class="org-src-container">
<pre class="src src-ipython">from datetime import datetime
date = str(datetime.now())
with open("../data/external/crawl-log-" + date + ".txt",'w') as temp_file:
    crawl = subprocess.Popen(command, stdout=temp_file, cwd=cwd)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org0ce5cb5" class="outline-4">
<h4 id="org0ce5cb5"><span class="section-number-4">1.4.3</span> Look for multiple keywords</h4>
<div class="outline-text-4" id="text-1-4-3">
</div>
<ol class="org-ol">
<li><a id="org2fb7b77"></a>tool: keywords list<br />
<div class="outline-text-5" id="text-1-4-3-1">
<p>
use results from Queries
</p>
</div>
</li>
<li><a id="org716c955"></a>reduce dataframe<br />
<ol class="org-ol">
<li><a id="org492179d"></a>boolean serie<br />
<div class="outline-text-6" id="text-1-4-3-2-1">
<div class="org-src-container">
<pre class="src src-ipython">df_bool = pd.DataFrame()
for query in queries_selected:
    df_bool[query] = df.desc.str.contains(query)
</pre>
</div>
</div>
</li>

<li><a id="orga0ec84c"></a>binary serie<br />
<div class="outline-text-6" id="text-1-4-3-2-2">
<div class="org-src-container">
<pre class="src src-ipython">def bool_to_bin(x):
    if x is True:
	return 1
    else:
	return 0

df_bin = pd.DataFrame()

for query in queries_selected:
    df_bin[query] = df_bool[query].apply(bool_to_bin)
</pre>
</div>
</div>
</li>

<li><a id="org52c79af"></a>score attribution<br />
<ol class="org-ol">
<li><a id="org4d4d089"></a>overview<br />
<div class="outline-text-7" id="text-1-4-3-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">pd.concat({"title":df.title, "score":df_bin.sum(axis=1)}, axis=1).sort_values("score", ascending=False)
</pre>
</div>
</div>
</li>

<li><a id="org34a40e8"></a>reduce dataframe for visual exploration<br />
<div class="outline-text-7" id="text-1-4-3-2-3-2">
<div class="org-src-container">
<pre class="src src-ipython">df_print = df
df_print["score"] = df_bin.sum(axis=1)
df_print = df_print.sort_values("score", ascending=False)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>

<li><a id="org2732ee3"></a>guide: used words<br />
<ol class="org-ol">
<li><a id="orga8f9412"></a>amongst keywords<br />
<div class="outline-text-6" id="text-1-4-3-3-1">
<div class="org-src-container">
<pre class="src src-ipython">df_bin.sum().sort_values(ascending=False)
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="orgaa26618"></a>which contains most of the querie keywords ?<br /></li>
<li><a id="orgc0fa6d9"></a>add weight to keywords ?<br /></li>
<li><a id="org56affcf"></a>keywords distance map<br />
<div class="outline-text-5" id="text-1-4-3-6">
<p>
with all keywords, you are at the center
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org5d13fa6" class="outline-4">
<h4 id="org5d13fa6"><span class="section-number-4">1.4.4</span> companies</h4>
<div class="outline-text-4" id="text-1-4-4">
<div class="org-src-container">
<pre class="src src-ipython">df = df[df.company.str.contains("berlin", case=False, na=False)]
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga8dd65c" class="outline-3">
<h3 id="orga8dd65c"><span class="section-number-3">1.5</span> Stats</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgefdc823" class="outline-4">
<h4 id="orgefdc823"><span class="section-number-4">1.5.1</span> overview</h4>
<div class="outline-text-4" id="text-1-5-1">
</div>
<ol class="org-ol">
<li><a id="orgbc3765b"></a>head<br />
<div class="outline-text-5" id="text-1-5-1-1">
<div class="org-src-container">
<pre class="src src-ipython">df.head()
</pre>
</div>
</div>
</li>

<li><a id="org0f70445"></a>count<br />
<div class="outline-text-5" id="text-1-5-1-2">
<div class="org-src-container">
<pre class="src src-ipython">len(df)
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org7d862b5" class="outline-4">
<h4 id="org7d862b5"><span class="section-number-4">1.5.2</span> days ago</h4>
<div class="outline-text-4" id="text-1-5-2">
</div>
<ol class="org-ol">
<li><a id="orga5fe61c"></a>histogram<br />
<ol class="org-ol">
<li><a id="org911fce0"></a>pd plot<br />
<div class="outline-text-6" id="text-1-5-2-1-1">
<div class="org-src-container">
<pre class="src src-ipython">df.days_ago.plot.hist()
</pre>
</div>
</div>
</li>
</ol>
</li>
<li><a id="orgb0335d8"></a>value count<br />
<div class="outline-text-5" id="text-1-5-2-2">
<div class="org-src-container">
<pre class="src src-ipython">df.days_ago.value_counts()
</pre>
</div>
</div>
</li>
<li><a id="orgcc96d6a"></a>groupby<br />
<ol class="org-ol">
<li><a id="org79254ff"></a>basic output<br />
<div class="outline-text-6" id="text-1-5-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">df.groupby(["days_ago"]).groups
</pre>
</div>
</div>
</li>
<li><a id="org3069319"></a>loop print<br />
<div class="outline-text-6" id="text-1-5-2-3-2">
<div class="org-src-container">
<pre class="src src-ipython">grouped = df.groupby("days_ago")

for name,group in grouped:
    print(name)
    print(group)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
<div id="outline-container-org9d77690" class="outline-3">
<h3 id="org9d77690"><span class="section-number-3">1.6</span> Printing</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org0b2df89" class="outline-4">
<h4 id="org0b2df89"><span class="section-number-4">1.6.1</span> quick overview</h4>
<div class="outline-text-4" id="text-1-6-1">
</div>
<ol class="org-ol">
<li><a id="org88e05ea"></a>head<br />
<div class="outline-text-5" id="text-1-6-1-1">
<div class="org-src-container">
<pre class="src src-ipython">df.head()
</pre>
</div>
</div>
</li>

<li><a id="orgb9565ca"></a>count<br />
<div class="outline-text-5" id="text-1-6-1-2">
<div class="org-src-container">
<pre class="src src-ipython">df.title.count()
</pre>
</div>
</div>
</li>
<li><a id="org0640c8f"></a>titles<br />
<div class="outline-text-5" id="text-1-6-1-3">
<div class="org-src-container">
<pre class="src src-ipython">df.title
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org81993ed" class="outline-4">
<h4 id="org81993ed"><span class="section-number-4">1.6.2</span> html pages</h4>
<div class="outline-text-4" id="text-1-6-2">
</div>
<ol class="org-ol">
<li><a id="org4387df8"></a>hacked around solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<ol class="org-ol">
<li><a id="org61734f0"></a>function to save results to html<br />
<div class="outline-text-6" id="text-1-6-2-1-1">
<div class="org-src-container">
<pre class="src src-ipython" id="org7586169">from datetime import datetime
from os import mkdir

def htmlexport(df, begin, end):
	    date = str(datetime.now())
	    path = "../reports/html/" + date + "/"
	    mkdir(path)
	    for i in range(begin, end):
			html = ""
			html = html + "\n"
			html = html + "Job number " + str(i)
			html = html + "\n"
			html = html + "-"*100
			html = html + "\n" + df.title.iloc[i]
			html = html + "\n"
			html = html + df.company.iloc[i]
			html = html + "\n"
			html = html + "-"*100
			html = html + "\n"
			html = html + df.desc.iloc[i]
			html = html + "\n"*3
			html = html + "-"*100
			html = html + "\n"*3
			filename = path + "job-" + str(i) + ".html"
			with open(filename, "a") as file:
				    file.write(html)
</pre>
</div>
</div>
</li>

<li><a id="org28d64a3"></a>call function<br />
<div class="outline-text-6" id="text-1-6-2-1-2">
<div class="org-src-container">
<pre class="src src-ipython">htmlexport(dfk, 0, dfk.title.count())
</pre>
</div>
</div>
</li>
<li><a id="orgb37a312"></a>PB : imossible to add links because of some encoding pb<br /></li>
</ol>
</li>
<li><a id="orgf146514"></a>use xml.dom&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<ol class="org-ol">
<li><a id="org16d5279"></a>use<br />
<div class="outline-text-6" id="text-1-6-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">from xml.dom import minidom
minidom.parseString(dfk.desc.iloc[10])
</pre>
</div>
</div>
</li>

<li><a id="org01c5501"></a>PB : some descs are separated by comas<br />
<ol class="org-ol">
<li><a id="orgc343c9e"></a>change spider<br /></li>
<li><a id="orgb0544da"></a>use regexp to parse again<br /></li>
<li><a id="orgec4dc96"></a>test with proper html files : maybe it is just not working with html ?<br />
<div class="outline-text-7" id="text-1-6-2-2-2-3">
<div class="org-src-container">
<pre class="src src-ipython">from xml.dom import minidom
minidom.parseString("~/code/web/plasma-city/application/static/front.html")
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>

<li><a id="org55a4ae6"></a>use yattag<br />
<ol class="org-ol">
<li><a id="orgb040cc3"></a>imports<br />
<div class="outline-text-6" id="text-1-6-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">from datetime import datetime
from os import mkdir
from yattag import Doc
</pre>
</div>
</div>
</li>

<li><a id="org7df9f3d"></a>html page generation<br />
<ol class="org-ol">
<li><a id="org0cf9931"></a>functions definition<br />
<div class="outline-text-7" id="text-1-6-2-3-2-1">
<div class="org-src-container">
<pre class="src src-ipython">def linksgen(filename_base, pagenum, url):
    doc, tag, text = Doc().tagtext()

    with tag("div"):
	with tag('a', href = "."):
	    text('Home page')
	with tag("div"):
	    with tag("a", href = filename_base + str(pagenum - 1) + ".html"):
		text("Previous page")
	    text(" ")
	    with tag("a", href = filename_base + str(pagenum + 1) + ".html"):
		text("Next page")
	with tag("a", href = url, target="_blank"):
	    text("Original page")

    return doc.getvalue()


def pagegen(filename_base, pagenum, title, desc, company, days, url):
    doc, tag, text = Doc().tagtext()

    doc.asis('&lt;meta charset="UTF-8"&gt;')
    with tag("title"):
	text(title)
    with tag("body"):
	doc.asis(linksgen(filename_base, pagenum, url))
	with tag("h1"):
	    text(title)
	with tag("h2"):
	    text(company)
	with tag("p"):
	    text(str(days) + " days ago")
	with tag("div"):
	    doc.asis(desc)
	doc.asis(linksgen(filename_base, pagenum, url))

    return doc.getvalue()
</pre>
</div>
</div>
</li>

<li><a id="org8a67c75"></a>test pagegen&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<div class="outline-text-7" id="text-1-6-2-3-2-2">
<div class="org-src-container">
<pre class="src src-ipython">pagegen("nom", 0, "titre", "desc", "firm", "days", "www")
</pre>
</div>
</div>
</li>

<li><a id="org352b8ed"></a>test linksgen&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<div class="outline-text-7" id="text-1-6-2-3-2-3">
<div class="org-src-container">
<pre class="src src-ipython">linksgen("file", 10, "wwwww")
</pre>
</div>
</div>
</li>
</ol>
</li>
<li><a id="org3417f51"></a>htmlexport function<br />
<ol class="org-ol">
<li><a id="org5c94af5"></a>definition<br />
<div class="outline-text-7" id="text-1-6-2-3-3-1">
<div class="org-src-container">
<pre class="src src-ipython">def htmlexport(df, begin, end):
    date = str(datetime.now())
    path = "../reports/html/" + date + "/"
    mkdir(path)
    for i in range(begin, end):
	filename_base = "job-"
	html = pagegen(filename_base,
		       i,
		       df.title.iloc[i],
		       df.desc.iloc[i],
		       df.company.iloc[i],
		       df.days_ago.iloc[i],
		       df.url.iloc[i]
	)
	filename = path + filename_base +  str(i) + ".html"
	with open(filename, "a") as file:
	    file.write(html)

</pre>
</div>
</div>
</li>

<li><a id="org974f644"></a>call<br />
<div class="outline-text-7" id="text-1-6-2-3-3-2">
<div class="org-src-container">
<pre class="src src-ipython">htmlexport(df_print, 0, 40)
</pre>
</div>
</div>
</li>

<li><a id="orgb0c25fd"></a>link<br />
<div class="outline-text-7" id="text-1-6-2-3-3-3">
<p>
<a href="home/teddd/data/projects/jobseeker/reports/html/">home/teddd/data/projects/jobseeker/reports/html/</a>
</p>
</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-orgd8c4276" class="outline-4">
<h4 id="orgd8c4276"><span class="section-number-4">1.6.3</span> server</h4>
<div class="outline-text-4" id="text-1-6-3">
</div>
<ol class="org-ol">
<li><a id="org7eb101d"></a>flask ? :D !!!<br /></li>
</ol>
</div>
<div id="outline-container-orgc53936c" class="outline-4">
<h4 id="orgc53936c"><span class="section-number-4">1.6.4</span> org  table (python)&#xa0;&#xa0;&#xa0;<span class="tag"><span class="python">python</span></span></h4>
<div class="outline-text-4" id="text-1-6-4">
</div>
<ol class="org-ol">
<li><a id="org6edefcb"></a>john kitchin example&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span><br />
<div class="outline-text-5" id="text-1-6-4-1">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">import</span> pandas <span style="font-weight: bold;">as</span> pd
<span style="font-weight: bold; font-style: italic;">test</span> = pd.DataFrame({<span style="font-style: italic;">'A'</span>: [1000, 1000], <span style="font-style: italic;">'B'</span> : [60, 100]})
<span style="font-weight: bold; font-style: italic;">test2</span> = [<span style="font-weight: bold;">list</span>(test)] + [<span style="font-weight: bold; text-decoration: underline;">None</span>] + test.values.tolist()
<span style="font-weight: bold; font-style: italic;">test3</span> = test.values.tolist()
<span style="font-weight: bold;">return</span> (test, test2, test3)
</pre>
</div>
</div>
</li>

<li><a id="org4c8be80"></a>my program&#xa0;&#xa0;&#xa0;<span class="tag"><span class="slow">slow</span></span><br />
<div class="outline-text-5" id="text-1-6-4-2">
<div class="org-src-container">
<pre class="src src-python" id="orgd8fb95c"><span style="font-weight: bold;">import</span> pandas <span style="font-weight: bold;">as</span> pd
<span style="font-weight: bold; font-style: italic;">df</span> = pd.read_csv(data)
<span style="font-weight: bold;">return</span>  [<span style="font-weight: bold;">list</span>(df)] + [<span style="font-weight: bold; text-decoration: underline;">None</span>] + df.values.tolist()
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org737768f" class="outline-4">
<h4 id="org737768f"><span class="section-number-4">1.6.5</span> org results: html&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></h4>
<div class="outline-text-4" id="text-1-6-5">
<div class="org-src-container">
<pre class="src src-python">dfk.desc.iloc[0]
</pre>
</div>
</div>
</div>

<div id="outline-container-org030954f" class="outline-4">
<h4 id="org030954f"><span class="section-number-4">1.6.6</span> soupprint</h4>
<div class="outline-text-4" id="text-1-6-6">
</div>
<ol class="org-ol">
<li><a id="org71dbe1c"></a>session functions<br />
<ol class="org-ol">
<li><a id="org4655f22"></a>souper (using get text)<br />
<div class="outline-text-6" id="text-1-6-6-1-1">
<div class="org-src-container">
<pre class="src src-ipython">from bs4 import BeautifulSoup

def souper(html):
    "returns only the text from a html string"
    soup = BeautifulSoup(html, 'html.parser')
    return soup.get_text()
</pre>
</div>
</div>
</li>
<li><a id="org573970a"></a>soupprint<br />
<ol class="org-ol">
<li><a id="org47991fa"></a>definition<br />
<div class="outline-text-7" id="text-1-6-6-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">from bs4 import BeautifulSoup

def souper(html):
    soup = BeautifulSoup(html, 'html.parser')
    print(soup.get_text())

def soupprint(df, begin, end):
    for i in range(begin, end):
	print(i, df.title.iloc[i])
	print("\n")
	print(df.company.iloc[i])
	print("\n")
	souper(df.desc.iloc[i])
	print("\n"*3)
	print("-"*100)
	print("\n"*3)
</pre>
</div>
</div>
</li>
<li><a id="org486630a"></a>call<br />
<div class="outline-text-7" id="text-1-6-6-1-2-2">
<div class="org-src-container">
<pre class="src src-ipython">soupprint(df, 0, 10)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>

<li><a id="org9b271d3"></a>soupprint as org function<br />
<ol class="org-ol">
<li><a id="org9e2244e"></a>definition<br />
<div class="outline-text-6" id="text-1-6-6-2-1">
<div class="org-src-container">
<pre class="src src-python" id="org63a5096"><span style="font-weight: bold;">from</span> bs4 <span style="font-weight: bold;">import</span> BeautifulSoup

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">souper</span>(html):
    <span style="font-weight: bold; font-style: italic;">soup</span> = BeautifulSoup(html, <span style="font-style: italic;">'html.parser'</span>)
    <span style="font-weight: bold;">print</span>(soup.get_text())

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">soupprint</span>(df, begin, end):
    <span style="font-weight: bold;">for</span> i <span style="font-weight: bold;">in</span> <span style="font-weight: bold;">range</span>(begin, end):
        <span style="font-weight: bold;">print</span>(i, df.title.iloc[i])
        <span style="font-weight: bold;">print</span>(<span style="font-style: italic;">"\n"</span>)
        <span style="font-weight: bold;">print</span>(df.company.iloc[i])
        <span style="font-weight: bold;">print</span>(<span style="font-style: italic;">"\n"</span>)
        souper(df.desc.iloc[i])
        <span style="font-weight: bold;">print</span>(<span style="font-style: italic;">"\n"</span>*3)
        <span style="font-weight: bold;">print</span>(<span style="font-style: italic;">"-"</span>*100)
        <span style="font-weight: bold;">print</span>(<span style="font-style: italic;">"\n"</span>*3)
</pre>
</div>
</div>
</li>

<li><a id="orgb68622c"></a>call<br />
<div class="outline-text-6" id="text-1-6-6-2-2">
<div class="org-src-container">
<pre class="src src-python">soupprint(dfk, 0, dfk.title.count())
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-orga72d20a" class="outline-2">
<h2 id="orga72d20a"><span class="section-number-2">2</span> External Documentation</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org3b2afcd" class="outline-3">
<h3 id="org3b2afcd"><span class="section-number-3">2.1</span> doc : look for matching patern&#xa0;&#xa0;&#xa0;<span class="tag"><span class="doc">doc</span></span></h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-ipython">help(df.title.str.contains)
</pre>
</div>
</div>
</div>

<div id="outline-container-org6c8455f" class="outline-3">
<h3 id="org6c8455f"><span class="section-number-3">2.2</span> pandas</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<a href="file:///home/teddd/Cours/Data/cheat-sheets/Pandas_Cheat_Sheet.pdf">Pandas cheat sheet</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org39df398" class="outline-2">
<h2 id="org39df398"><span class="section-number-2">3</span> Tests</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgd17e283" class="outline-3">
<h3 id="orgd17e283"><span class="section-number-3">3.1</span> ob-ipython</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-orgf5d96a1" class="outline-4">
<h4 id="orgf5d96a1"><span class="section-number-4">3.1.1</span> hands-on tryout</h4>
<div class="outline-text-4" id="text-3-1-1">
</div>
<ol class="org-ol">
<li><a id="org59b55a0"></a>hello world<br />
<div class="outline-text-5" id="text-3-1-1-1">
<div class="org-src-container">
<pre class="src src-ipython">print 'hello world'
</pre>
</div>
</div>
</li>
<li><a id="org2c9ca89"></a>function definition<br />
<div class="outline-text-5" id="text-3-1-1-2">
<div class="org-src-container">
<pre class="src src-ipython">def fn():
    print "I am in the session !"
</pre>
</div>
</div>
</li>

<li><a id="org36774d7"></a>function call<br />
<div class="outline-text-5" id="text-3-1-1-3">
<div class="org-src-container">
<pre class="src src-ipython">fn()
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org845f7d3" class="outline-4">
<h4 id="org845f7d3"><span class="section-number-4">3.1.2</span> doc tutorial</h4>
<div class="outline-text-4" id="text-3-1-2">
</div>
<ol class="org-ol">
<li><a id="org2112dc2"></a>imports<br />
<div class="outline-text-5" id="text-3-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
</pre>
</div>
</div>
</li>

<li><a id="org473943f"></a>ex2<br />
<div class="outline-text-5" id="text-3-1-2-2">
<div class="org-src-container">
<pre class="src src-ipython">def foo(x):
    return x + 9

[foo(x) + 7 for x in range(7)]
</pre>
</div>
</div>
</li>

<li><a id="orga5a3714"></a>images<br />
<ol class="org-ol">
<li><a id="org222c5c9"></a>ex1<br />
<div class="outline-text-6" id="text-3-1-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">plt.hist(np.random.randn(20000), bins=200)
</pre>
</div>
</div>
</li>

<li><a id="org7515255"></a>ex2<br />
<div class="outline-text-6" id="text-3-1-2-3-2">
<div class="org-src-container">
<pre class="src src-ipython">plt.hist(np.random.randn(20000), bins=200)
</pre>
</div>
</div>
</li>

<li><a id="orga94b249"></a>config<br />
<div class="outline-text-6" id="text-3-1-2-3-3">
<div class="org-src-container">
<pre class="src src-ipython">%config InlineBackend.figure_format = 'svg'
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="org569f3c3"></a>other kernel<br />
<div class="outline-text-5" id="text-3-1-2-4">
<div class="org-src-container">
<pre class="src src-ipython">(+ 1 2)
</pre>
</div>
</div>
</li>

<li><a id="org95be6a6"></a>async<br />
<div class="outline-text-5" id="text-3-1-2-5">
<div class="org-src-container">
<pre class="src src-ipython">import time
time.sleep(3)
plt.hist(np.random.randn(20000), bins=200)
</pre>
</div>
</div>
</li>
</ol>
</div>

<div id="outline-container-org445b9a4" class="outline-4">
<h4 id="org445b9a4"><span class="section-number-4">3.1.3</span> other tryouts</h4>
<div class="outline-text-4" id="text-3-1-3">
</div>
<ol class="org-ol">
<li><a id="org08a6997"></a>functions<br />
<div class="outline-text-5" id="text-3-1-3-1">
</div>
<ol class="org-ol">
<li><a id="orgf866534"></a>call<br />
<div class="outline-text-6" id="text-3-1-3-1-1">
<div class="org-src-container">
<pre class="src src-ipython">lol()
</pre>
</div>
</div>
</li>
</ol>
</li>

<li><a id="orgabde600"></a>formater<br />
<div class="outline-text-5" id="text-3-1-3-2">
</div>
<ol class="org-ol">
<li><a id="org6e2f8d3"></a>init<br />
<div class="outline-text-6" id="text-3-1-3-2-1">
<div class="org-src-container">
<pre class="src src-ipython">import IPython
from tabulate import tabulate

class OrgFormatter(IPython.core.formatters.BaseFormatter):
    def __call__(self, obj):
	try:
	    return tabulate(obj, headers='keys',
			    tablefmt='orgtbl', showindex='always')
	except:
	    return None

ip = get_ipython()
ip.display_formatter.formatters['text/org'] = OrgFormatter()
</pre>
</div>
</div>
</li>
<li><a id="org40699d9"></a>arrays<br /></li>
</ol>
</li>

<li><a id="org1e36bc9"></a>kernel tests<br />
<ol class="org-ol">
<li><a id="org63a7eeb"></a>session header arg after run console<br />
<div class="outline-text-6" id="text-3-1-3-3-1">
<div class="org-src-container">
<pre class="src src-ipython">print("hello")
</pre>
</div>
</div>
</li>
<li><a id="orgf7bda0a"></a>kernel headerarg<br />
<div class="outline-text-6" id="text-3-1-3-3-2">
<div class="org-src-container">
<pre class="src src-ipython">print("hello")
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgc5dfe43" class="outline-3">
<h3 id="orgc5dfe43"><span class="section-number-3">3.2</span> nltk</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org479261f" class="outline-4">
<h4 id="org479261f"><span class="section-number-4">3.2.1</span> text selection</h4>
<div class="outline-text-4" id="text-3-2-1">
</div>
<ol class="org-ol">
<li><a id="org4f8bb3d"></a>sample text base<br />
<div class="outline-text-5" id="text-3-2-1-1">
<div class="org-src-container">
<pre class="src src-ipython">from nltk.book import *
</pre>
</div>
</div>
</li>
<li><a id="org6a7aa8c"></a>access text as string<br />
<ol class="org-ol">
<li><a id="org9337f8a"></a>imports<br />
<div class="outline-text-6" id="text-3-2-1-2-1">
<div class="org-src-container">
<pre class="src src-ipython">import nltk, re, pprint
from nltk import word_tokenize
</pre>
</div>
</div>
</li>
<li><a id="org7931725"></a>with one description<br />
<ol class="org-ol">
<li><a id="org8fe0e6e"></a>definition<br />
<div class="outline-text-7" id="text-3-2-1-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">string = df.iloc[0].desc
</pre>
</div>
</div>
</li>

<li><a id="orgccabbe2"></a>formating<br />
<ol class="org-ol">
<li><a id="org65ab577"></a>html<br />
<div class="outline-text-8" id="text-3-2-1-2-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">string = souper(string)
</pre>
</div>
</div>
</li>

<li><a id="org1aab206"></a>case<br />
<div class="outline-text-8" id="text-3-2-1-2-2-2-2">
<div class="org-src-container">
<pre class="src src-ipython">string = string.lower()
</pre>
</div>
</div>
</li>

<li><a id="orgeb4c3ef"></a>punctiations<br />
<ol class="org-ol">
<li><a id="org9736db4"></a>definition<br />
<div class="outline-text-9" id="text-3-2-1-2-2-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">def multi_replace(string, *args, replace=" "):
    for target in args:
	string = string.replace(target, replace)
    return string

trash_car = (",", "\'", "\"", "&amp;", "#", "{", "}",
	     "(", ")", "[", "]", "_", "\\", "~", "-",
	     ",", ";", ":", ".", "?", "!", "+", "|",
	     "@", "/", "", "*", "", "", "%", "",
	     "")

</pre>
</div>
</div>
</li>

<li><a id="org898ff7f"></a>call<br />
<div class="outline-text-9" id="text-3-2-1-2-2-2-3-2">
<div class="org-src-container">
<pre class="src src-ipython">string = multi_replace(string, *trash_car)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>


<li><a id="org7edc730"></a>to ntlk text object<br />
<ol class="org-ol">
<li><a id="orgc808a6b"></a>tokenizing<br />
<div class="outline-text-7" id="text-3-2-1-2-3-1">
<div class="org-src-container">
<pre class="src src-ipython">tokens = word_tokenize(string)
</pre>
</div>
</div>
</li>

<li><a id="org584b140"></a>use as nltk text<br />
<div class="outline-text-7" id="text-3-2-1-2-3-2">
<div class="org-src-container">
<pre class="src src-ipython">text = nltk.Text(tokens)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-orgfcc920f" class="outline-4">
<h4 id="orgfcc920f"><span class="section-number-4">3.2.2</span> search</h4>
<div class="outline-text-4" id="text-3-2-2">
</div>
<ol class="org-ol">
<li><a id="org783cc4c"></a>concordance<br />
<div class="outline-text-5" id="text-3-2-2-1">
<div class="org-src-container">
<pre class="src src-ipython">text.concordance("data")
</pre>
</div>
</div>
</li>
<li><a id="org91fbbea"></a>similar word<br />
<div class="outline-text-5" id="text-3-2-2-2">
<div class="org-src-container">
<pre class="src src-ipython">text.similar("analyst")
</pre>
</div>
</div>
</li>
<li><a id="orgf80eaee"></a>dispersion<br />
<div class="outline-text-5" id="text-3-2-2-3">
<div class="org-src-container">
<pre class="src src-ipython">text.dispersion_plot(["up", "with", "in", "the", "for", "team"])
</pre>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org1c05c7a" class="outline-4">
<h4 id="org1c05c7a"><span class="section-number-4">3.2.3</span> generation&#xa0;&#xa0;&#xa0;<span class="tag"><span class="test">test</span></span></h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<pre class="src src-ipython">text.generate(["The", "job", "is", "for", "data", "team"])
</pre>
</div>
</div>
</div>

<div id="outline-container-org2adce2a" class="outline-4">
<h4 id="org2adce2a"><span class="section-number-4">3.2.4</span> normalizing</h4>
<div class="outline-text-4" id="text-3-2-4">
</div>
<ol class="org-ol">
<li><a id="orgeaf59b5"></a>steaming<br /></li>
<li><a id="org4f39334"></a>lemmatization<br /></li>
</ol>
</div>
<div id="outline-container-orgb9e75d1" class="outline-4">
<h4 id="orgb9e75d1"><span class="section-number-4">3.2.5</span> vocabulary</h4>
<div class="outline-text-4" id="text-3-2-5">
</div>
<ol class="org-ol">
<li><a id="org09a45db"></a>sorted set<br />
<div class="outline-text-5" id="text-3-2-5-1">
<div class="org-src-container">
<pre class="src src-ipython">sorted(set(text))
</pre>
</div>
</div>
</li>
<li><a id="org8aad863"></a>lexical richness<br />
<ol class="org-ol">
<li><a id="orgdaa8ecc"></a>tryout<br />
<div class="outline-text-6" id="text-3-2-5-2-1">
<div class="org-src-container">
<pre class="src src-ipython">len(text) / len(set(text))
</pre>
</div>
</div>
</li>

<li><a id="org5fdbea4"></a>function<br />
<div class="outline-text-6" id="text-3-2-5-2-2">
<div class="org-src-container">
<pre class="src src-ipython">def lexical_diversity(text):
    return len(text) / len(set(text))
</pre>
</div>
</div>
</li>
</ol>
</li>
<li><a id="org38753a1"></a>specific word<br />
<ol class="org-ol">
<li><a id="orgbd7c17b"></a>tryout<br />
<div class="outline-text-6" id="text-3-2-5-3-1">
<div class="org-src-container">
<pre class="src src-ipython">100 * text.count('for') / len(text)
</pre>
</div>
</div>
</li>
<li><a id="org7912577"></a>functyion<br />
<div class="outline-text-6" id="text-3-2-5-3-2">
<div class="org-src-container">
<pre class="src src-ipython">def word_percentage(word):
    return 100 * text.count(word) / len(text)
</pre>
</div>
</div>
</li>
</ol>
</li>
</ol>
</div>

<div id="outline-container-org27008b3" class="outline-4">
<h4 id="org27008b3"><span class="section-number-4">3.2.6</span> <span class="todo TODO">TODO</span> Build a corpus !</h4>
<div class="outline-text-4" id="text-3-2-6">
</div>
<ol class="org-ol">
<li><a id="org39d1666"></a>sklearn<br />
<div class="outline-text-5" id="text-3-2-6-1">
<div class="org-src-container">
<pre class="src src-ipython">docs = df['desc']

tfs = tfidf.fit_transform(docs)
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: teddd</p>
<p class="date">Created: 2018-10-05 ven. 17:39</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>

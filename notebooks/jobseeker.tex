% Created 2018-10-02 mar. 16:07
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\author{teddd}
\date{\today}
\title{}
\hypersetup{
 pdfauthor={teddd},
 pdftitle={},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 26.1 (Org mode 9.1.9)}, 
 pdflang={English}}
\begin{document}

\tableofcontents

\section{Project description}
\label{sec:org5d73a31}
\subsection{General Description}
\label{sec:orgd7025d0}
Goal : Find jobs
\subsubsection{Use}
\label{sec:org4a57949}
\begin{enumerate}
\item target opportunities
\label{sec:org0733151}
\begin{enumerate}
\item sheets of wanted words
\label{sec:org05a9acb}
\item query matching algorithms
\label{sec:org996a336}
\end{enumerate}
\item data exploration
\label{sec:orgdba73f5}
\item cluster
\label{sec:org800a7fb}
\begin{enumerate}
\item nlp
\label{sec:org860c87d}
\end{enumerate}
\item find jobs I didn't know about
\label{sec:org8700713}
\item get warned if new opportunities
\label{sec:org8a1ac34}
\item use it as a model for finding my perfect match in the world / exploring the economy
\label{sec:orgc7650f6}
\item make it open source and useable by anyone
\label{sec:org4ccd3a0}
\end{enumerate}
\subsubsection{Features}
\label{sec:org4c643df}
\begin{enumerate}
\item Update
\label{sec:orgd324c12}
\item Clustering
\label{sec:orge495072}
\item Visualization
\label{sec:org0ae0224}
\end{enumerate}
\subsection{Plan}
\label{sec:org61cd138}
\subsubsection{Ebay jobs quick scrap}
\label{sec:orgb52a3e2}
\begin{enumerate}
\item Think about it while normal digging
\label{sec:org943e3e7}
\item Build a simple tool to access the info offline and stay up to date
\label{sec:org183919c}
\item List the wanted features and their learning prerequisites
\label{sec:orgf12c628}
\end{enumerate}
\subsubsection{Blogging}
\label{sec:org01462ee}
\begin{enumerate}
\item Org babel
\label{sec:orgc088fe8}
\item Website
\label{sec:org3fdd88e}
\end{enumerate}
\subsubsection{Courses}
\label{sec:orge6f4216}
\begin{enumerate}
\item Databases
\label{sec:orgc7797f3}
\item Visualization
\label{sec:org3a80613}
\item Machine learning
\label{sec:org79df7f9}
\item NLP
\label{sec:org93bbaa9}
\item Hash tables / numpy computation
\label{sec:org870dae6}
\item Proba / stats
\label{sec:orgeb743f5}
\end{enumerate}
\subsubsection{Jobs seeker}
\label{sec:orgefbdabc}
\subsection{Implementation}
\label{sec:orgadb3841}
\subsubsection{Start a clean project}
\label{sec:orgdd4c535}
\begin{enumerate}
\item {\bfseries\sffamily TODO} git
\label{sec:orgc0f0156}
\begin{enumerate}
\item a branch per functionality
\label{sec:orgc7f3440}
\end{enumerate}
\item {\bfseries\sffamily TODO} projectile
\label{sec:orge84c594}
\item file system
\label{sec:org11fe25d}
\begin{enumerate}
\item /
\label{sec:orgbb2ce02}
\begin{enumerate}
\item org
\label{sec:org6b0e0bc}
\item scraper
\label{sec:orgfe16469}
\item database
\label{sec:orgb9dfdcd}
\item explorer
\label{sec:org48a93ac}
\end{enumerate}
\end{enumerate}
\item database
\label{sec:org35dc1bd}
\begin{enumerate}
\item sql ?
\label{sec:orga3fdb89}
\item csv ?
\label{sec:orgeaccb63}
\end{enumerate}
\item org babel file / emacs env
\label{sec:orgad61787}
\begin{enumerate}
\item snippets
\label{sec:orga7a6f57}
C-c \& \ldots{}
Tables
C-c C-t is snippet mode for test
\item {\bfseries\sffamily TODO} track time
\label{sec:org5f4007e}
\item track habits
\label{sec:org941eaae}
\item decide what goes public and what does not at expension
\label{sec:org497a888}
\end{enumerate}
\end{enumerate}
\section{Explorer}
\label{sec:org961d6b8}
Proper program.
\subsection{Imports}
\label{sec:orgc9a0115}
\subsubsection{ipython}
\label{sec:orgfca6a0f}
\begin{verbatim}
%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
\end{verbatim}
\subsubsection{pandas}
\label{sec:orgf8d91d1}
\begin{verbatim}
import pandas as pd    
\end{verbatim}

\subsection{Data load}
\label{sec:org18efb36}
\subsubsection{load everything}
\label{sec:orgacbe5d9}
\begin{enumerate}
\item file list with path
\label{sec:org2f745f4}
\begin{verbatim}
import os
csv_files = []
date = "2018-09-30"
for dirpath, dirs, files in os.walk("../data/raw/" + date): 
  for filename in files:
    fname = os.path.join(dirpath,filename)
    if fname.endswith('.csv'):
      csv_files.append(fname)
\end{verbatim}
\item dataframe creation
\label{sec:orgf6914d4}
\begin{verbatim}
jobs = pd.DataFrame()

for fl in csv_files:
    print(fl+(30-len(fl)//2)*" *")
    try:
	jobs_set = pd.read_csv(fl)
	jobs_set.dropna(axis=0, how='any', subset=["desc"], inplace=True)
	jobs_set.drop_duplicates(subset="desc", inplace=True)            
	try:                                                             
	    jobs.iloc[0,0]                                               
	    jobs = jobs.append(jobs_set)                                 
	except IndexError:                                               
	    jobs = jobs_set                                              
    except pd.errors.EmptyDataError:
	pass
\end{verbatim}

\item {\bfseries\sffamily TODO} time range selection
\label{sec:org6dec77c}
\end{enumerate}
\subsubsection{rename}
\label{sec:orgcb33b0b}
use to quickly reset original df
\begin{verbatim}
df = jobs
\end{verbatim}

\subsubsection{python example\hfill{}\textsc{test}}
\label{sec:org304b20a}
\begin{verbatim}
x = 12
return x
\end{verbatim}

\begin{verbatim}
return int(x)+1
\end{verbatim}

\subsubsection{org doc elisp example\hfill{}\textsc{test}}
\label{sec:orgcacffd1}
\begin{center}
\label{tab:org40e6bf5}
\begin{tabular}{r}
1\\
2\\
3\\
4\\
\end{tabular}
\end{center}

\subsubsection{python\hfill{}\textsc{python}}
\label{sec:org6803f30}
\begin{verbatim}
"~/data/projects/jobseeker/data/raw/18-09-07/dsp.csv"
\end{verbatim}

\begin{verbatim}
"~/data/projects/jobseeker/data/raw/18-09-07/dsp.csv"
\end{verbatim}

\begin{verbatim}
"~/data/projects/jobseeker/data/raw/18-09-07/python.csv"
\end{verbatim}

\begin{verbatim}
"~/data/projects/jobseeker/data/raw/18-09-07/data scientist.csv"
\end{verbatim}

\begin{verbatim}
"~/data/projects/jobseeker/data/raw/18-09-07/software engineer.csv"
\end{verbatim}
\subsection{Cleansing / Formating\hfill{}\textsc{clean}}
\label{sec:orgeb13c62}
\subsubsection{duplicates}
\label{sec:org2315923}
\begin{enumerate}
\item drop\(_{\text{duplicates}}\)
\label{sec:org0389113}
\begin{verbatim}
df.drop_duplicates(subset="desc", inplace=True)
\end{verbatim}

\item count
\label{sec:org4311707}
\begin{verbatim}
df.title.count()
\end{verbatim}
\end{enumerate}

\subsubsection{olders}
\label{sec:org0244041}
\begin{enumerate}
\item map lambda\hfill{}\textsc{test}
\label{sec:orgc5bbda3}
\begin{verbatim}
df = df[df.days_ago.str.contains("30+").map(lambda x: not x)]
\end{verbatim}

\item ==False
\label{sec:org71e1541}
\begin{verbatim}
df = df[df.days_ago.str.contains("30+")==False]
\end{verbatim}

\item count
\label{sec:orgabbef3c}
\begin{verbatim}
len(df)
\end{verbatim}
\end{enumerate}

\subsubsection{string numbers to integers}
\label{sec:org5f7f1db}
\begin{verbatim}
df["days_ago"] = df.days_ago.apply(lambda x: int(x))
\end{verbatim}
\subsubsection{drop erratic values}
\label{sec:orgef75dd9}
\begin{enumerate}
\item run
\label{sec:org8215081}
\begin{verbatim}
df = df[df.days_ago.lt(30)]
\end{verbatim}
\item tests
\label{sec:orgc692cd1}
\begin{verbatim}
df.days_ago.lt(30)
\end{verbatim}
\end{enumerate}
\subsubsection{rename}
\label{sec:org748c7b6}
\begin{verbatim}
df_clean = df
\end{verbatim}

\subsection{Filtering}
\label{sec:org72742f0}
\subsubsection{Look for 1 keywords}
\label{sec:orge3e85e9}
\begin{enumerate}
\item keyword definiton
\label{sec:org4a257f4}
\begin{enumerate}
\item org variable
\label{sec:orge0d20f4}
\begin{verbatim}
"kunst und medien"
\end{verbatim}
\end{enumerate}

\item look in title
\label{sec:org3064c22}
\begin{enumerate}
\item boolean serie construction\hfill{}\textsc{test}
\label{sec:org9c2d789}
\begin{verbatim}
df.title.str.contains(k, case=False)
\end{verbatim}

\item reduction of our dataset
\label{sec:org3df851a}
\begin{verbatim}
df = df[df.title.str.contains(k, case=False, na=False)]
\end{verbatim}
\end{enumerate}

\item look in description
\label{sec:org1f097d8}
\begin{verbatim}
df = df[df.desc.str.contains(k, case=False, na=False)]
\end{verbatim}

\item {\bfseries\sffamily TODO} test
\label{sec:orgced4613}
goto Johnny Kitchin
\begin{verbatim}
k
\end{verbatim}
\end{enumerate}
\subsubsection{Queries}
\label{sec:orgdd08e1e}
\begin{enumerate}
\item get queries metadata
\label{sec:orgdb4db68}
\begin{enumerate}
\item dataframe using os results
\label{sec:org878c805}
\begin{verbatim}
import os
queries_name = []
queries_size = []
queries_path = []
queries_time = []
for dirpath, dirs, files in os.walk("../data/raw"): 
  for filename in files:
    if filename.endswith('.csv'):

      path = os.path.join(dirpath, filename)
      queries_path.append(path)

      size = os.path.getsize(path)
      queries_size.append(size)

      fname = filename.replace(".csv", "")
      queries_name.append(fname)

      time = os.path.getmtime(path)
      queries_time.append(time)

queries = pd.DataFrame({"name" : queries_name, "path" : queries_path, "size" : queries_size, "time" : queries_time})      
\end{verbatim}
\item remove oldests results
\label{sec:org39c32e2}
\begin{enumerate}
\item datetime time format
\label{sec:org9b8ba40}
\begin{verbatim}
from datetime import datetime
queries["time"] = queries.time.apply(datetime.fromtimestamp)
\end{verbatim}

\item y-m-d format time
\label{sec:org9a76254}
\begin{verbatim}
def format_time(x):
    y = x.strftime("%Y-%m-%d")
    return y

queries["time_formated"] = queries.time.apply(format_time)
\end{verbatim}
\end{enumerate}
\item remove null size results
\label{sec:org2a096bd}
\begin{verbatim}
queries_null = queries[queries["size"] < 1]
queries = queries[queries["size"] > 1]
\end{verbatim}
\item number of entries in csv file
\label{sec:orge458d42}
\begin{enumerate}
\item read as pandas dataframe
\label{sec:org21e8f7e}
\begin{verbatim}
def entries_count(csv):
    return len(pd.read_csv(csv))

queries["entries"] = queries.path.apply(entries_count)
\end{verbatim}
\end{enumerate}

\item inspection
\label{sec:org1431e0e}
\begin{verbatim}
import humanize
queries["size_for_humans"] = queries["size"].apply(humanize.naturalsize)
queries.sort_values("size", ascending=False)[["name", "size_for_humans", "entries"]].reset_index()
\end{verbatim}

\item time evolution
\label{sec:org1e0a461}
\item return list for next scraper launch
\label{sec:org497a434}
\begin{enumerate}
\item remove null size results before (or not)
\label{sec:org646da0e}
\begin{verbatim}
queries_list = list(set(queries.name))
\end{verbatim}
\item save in a file for editing
\label{sec:orgc55e8dd}
\begin{verbatim}
with open("/queries/queries.txt", "w") as f:
    for query in queries_list:
	f.write(query + "\n")
\end{verbatim}
\end{enumerate}
\end{enumerate}
\item launch scraper with the list
\label{sec:org7165614}
\begin{enumerate}
\item get list from file
\label{sec:orgf1ae3d9}
\begin{verbatim}
with open("queries/best.txt", "r") as f:
    queries_selected = f.read()
    queries_selected = queries_selected.splitlines()
\end{verbatim}

\item run shell script as subprocess
\label{sec:orgb4bfbb2}
\begin{enumerate}
\item variables and imports
\label{sec:orgb356488}
\begin{verbatim}
import subprocess
from subprocess import Popen, PIPE
import shlex

cwd = '/home/teddd/data/projects/jobseeker/data/external/indeed/'
bash_script = [cwd + 'local_crawler_launch.sh']
arguments = queries_selected
command = bash_script + arguments
\end{verbatim}

\item execution
\label{sec:org2a16f03}
\begin{enumerate}
\item stdout to buffer
\label{sec:org203a985}
\begin{verbatim}
session = subprocess.Popen(command, stdout=PIPE, stderr=PIPE)
stdout, stderr = session.communicate()

if stderr:
    raise Exception("Error "+str(stderr))

stdout
\end{verbatim}

\item stdout to file
\label{sec:org34fcdd3}
\begin{verbatim}
from datetime import datetime
date = str(datetime.now())
with open("../data/external/crawl-log-" + date + ".txt",'w') as temp_file:
    crawl = subprocess.Popen(command, stdout=temp_file, cwd=cwd)
\end{verbatim}
\end{enumerate}
\end{enumerate}
\end{enumerate}
\end{enumerate}
\subsubsection{Look for multiple keywords}
\label{sec:org593843e}
\begin{enumerate}
\item tool: keywords list
\label{sec:orge76e20e}
use results from Queries
\item reduce dataframe
\label{sec:org4bdc84d}
\begin{enumerate}
\item boolean serie
\label{sec:org5cebe69}
\begin{verbatim}
df_bool = pd.DataFrame()
for query in queries_selected:
    df_bool[query] = df.desc.str.contains(query)
\end{verbatim}

\item binary serie
\label{sec:org1f7f9fb}
\begin{verbatim}
def bool_to_bin(x):
    if x is True:
	return 1
    else:
	return 0

df_bin = pd.DataFrame()

for query in queries_selected:
    df_bin[query] = df_bool[query].apply(bool_to_bin)
\end{verbatim}

\item score attribution
\label{sec:orgd11d3a6}

\begin{enumerate}
\item overview
\label{sec:org91f5757}
\begin{verbatim}
pd.concat({"title":df.title, "score":df_bin.sum(axis=1)}, axis=1).sort_values("score", ascending=False)
\end{verbatim}

\item reduce dataframe for visual exploration
\label{sec:org8401a16}
\begin{verbatim}
df_print = df
df_print["score"] = df_bin.sum(axis=1)
df_print = df_print.sort_values("score", ascending=False)
\end{verbatim}
\end{enumerate}
\end{enumerate}

\item guide: used words
\label{sec:org34dc34d}
\begin{enumerate}
\item amongst keywords
\label{sec:org64a2567}
\begin{verbatim}
df_bin.sum().sort_values(ascending=False)
\end{verbatim}
\end{enumerate}

\item which contains most of the querie keywords ?
\label{sec:org4a2b941}
\item add weight to keywords ?
\label{sec:org865ec73}
\item keywords distance map
\label{sec:orgbddaa07}
with all keywords, you are at the center
\end{enumerate}
\subsubsection{companies}
\label{sec:org67abcfe}
\begin{verbatim}
df = df[df.company.str.contains("berlin", case=False, na=False)]
\end{verbatim}
\subsection{Stats}
\label{sec:org2c2c7f7}
\subsubsection{overview}
\label{sec:org0770043}
\begin{enumerate}
\item head
\label{sec:org18ae5c0}
\begin{verbatim}
df.head()
\end{verbatim}

\item count
\label{sec:org3991554}
\begin{verbatim}
len(df)
\end{verbatim}
\end{enumerate}

\subsubsection{days ago}
\label{sec:org6df52dd}
\begin{enumerate}
\item histogram
\label{sec:org627f21e}
\begin{enumerate}
\item pd plot
\label{sec:orgf772232}
\begin{verbatim}
df.days_ago.plot.hist()
\end{verbatim}
\end{enumerate}
\item value count
\label{sec:orgf9b361b}
\begin{verbatim}
df.days_ago.value_counts()
\end{verbatim}
\item groupby
\label{sec:org8ce1252}
\begin{enumerate}
\item basic output
\label{sec:org03aaabb}
\begin{verbatim}
df.groupby(["days_ago"]).groups
\end{verbatim}
\item loop print
\label{sec:org9ae8962}
\begin{verbatim}
grouped = df.groupby("days_ago")

for name,group in grouped:
    print(name)
    print(group)
\end{verbatim}
\item documentation\hfill{}\textsc{doc}
\label{sec:org416afbb}
\begin{enumerate}
\item pandas doc
\label{sec:org9c3445c}
\begin{verbatim}
help(df.groupby(["days_ago"]))
\end{verbatim}
\item tutorial
\label{sec:orgd9a4f16}
\url{https://www.tutorialspoint.com/python\_pandas/python\_pandas\_groupby.htm}
\end{enumerate}
\item use
\label{sec:org6cc200b}
\begin{verbatim}
grouped = df.groupby(["days_ago"])
grouped.title.count().sort_values(ascending=False)
\end{verbatim}
\end{enumerate}
\end{enumerate}
\subsubsection{companies}
\label{sec:orgbe85ddd}
\begin{enumerate}
\item groupby
\label{sec:org1908700}
\begin{enumerate}
\item define group
\label{sec:org2ef7af7}
\begin{verbatim}
comp_group = df.groupby(["company"])
\end{verbatim}

\item print groups
\label{sec:org9c28d8b}
\begin{verbatim}
comp_group.groups
\end{verbatim}
\item count groups
\label{sec:org6930f1d}
\begin{verbatim}
len(comp_group.groups)
\end{verbatim}
\item number of job per company
\label{sec:org691ee97}
\begin{enumerate}
\item hack
\label{sec:org04f9b52}
\begin{enumerate}
\item loop
\label{sec:org7eaaf0a}
\begin{verbatim}
for company in comp_group.groups.keys():
	    lenght = len(comp_group.groups[company])
	    if lenght > 1:
			print(company, lenght)
\end{verbatim}

\item single
\label{sec:orgf061eda}
\begin{verbatim}
key = list(comp_group.groups.keys())[0]
list(comp_group.groups[key])
\end{verbatim}

\item test
\label{sec:orgc584759}
\begin{verbatim}
len(comp_group.groups["Fraunhofer-Institut für Nachrichtentechnik, Heinrich-Hertz-Institut"])
\end{verbatim}
\end{enumerate}
\item pandas
\label{sec:orgcf29eac}
\begin{verbatim}
count = comp_group.title.count()
count.sort_values(ascending=False)
\end{verbatim}
\end{enumerate}
\end{enumerate}

\item value count
\label{sec:org0287973}
\begin{verbatim}
df.company.value_counts()
\end{verbatim}
\end{enumerate}

\subsection{Words}
\label{sec:orge3c7301}
\subsubsection{most used word}
\label{sec:orgdc9d578}
\begin{enumerate}
\item category to look in
\label{sec:org4401ae7}
\begin{verbatim}
"desc"
\end{verbatim}

\item 
\label{sec:org3bc245e}
\end{enumerate}
\subsection{Printing}
\label{sec:org52be9dc}
\subsubsection{quick overview}
\label{sec:org4fc5910}
\begin{enumerate}
\item head
\label{sec:orgc764aa3}
\begin{verbatim}
df.head()
\end{verbatim}

\item count
\label{sec:org052cbd5}
\begin{verbatim}
df.title.count()
\end{verbatim}
\item titles
\label{sec:orgcec092b}
\begin{verbatim}
df.title
\end{verbatim}
\end{enumerate}

\subsubsection{html pages}
\label{sec:org317e9cb}
\begin{enumerate}
\item hacked around solution\hfill{}\textsc{test}
\label{sec:org931eb2b}
\begin{enumerate}
\item function to save results to html
\label{sec:orgca488ef}
\begin{verbatim}
from datetime import datetime
from os import mkdir

def htmlexport(df, begin, end):
	    date = str(datetime.now())
	    path = "../reports/html/" + date + "/"
	    mkdir(path)
	    for i in range(begin, end):
			html = ""
			html = html + "\n"
			html = html + "Job number " + str(i)
			html = html + "\n"
			html = html + "-"*100
			html = html + "\n" + df.title.iloc[i]
			html = html + "\n"
			html = html + df.company.iloc[i]
			html = html + "\n"
			html = html + "-"*100
			html = html + "\n"
			html = html + df.desc.iloc[i]
			html = html + "\n"*3
			html = html + "-"*100
			html = html + "\n"*3
			filename = path + "job-" + str(i) + ".html"
			with open(filename, "a") as file:
				    file.write(html)
\end{verbatim}

\item call function
\label{sec:org544b486}
\begin{verbatim}
htmlexport(dfk, 0, dfk.title.count())
\end{verbatim}
\item PB : imossible to add links because of some encoding pb
\label{sec:org267f263}
\end{enumerate}
\item use xml.dom\hfill{}\textsc{test}
\label{sec:orga5b9486}
\begin{enumerate}
\item use
\label{sec:org90e8503}
\begin{verbatim}
from xml.dom import minidom
minidom.parseString(dfk.desc.iloc[10])
\end{verbatim}

\item PB : some descs are separated by comas
\label{sec:org1cc5ebc}
\begin{enumerate}
\item change spider
\label{sec:orgb170fd3}
\item use regexp to parse again
\label{sec:org6fdc097}
\item test with proper html files : maybe it is just not working with html ?
\label{sec:org3496d50}
\begin{verbatim}
from xml.dom import minidom
minidom.parseString("~/code/web/plasma-city/application/static/front.html")
\end{verbatim}
\end{enumerate}
\end{enumerate}

\item use yattag
\label{sec:orgae80064}
\begin{enumerate}
\item imports
\label{sec:orgf5fd75b}
\begin{verbatim}
from datetime import datetime
from os import mkdir
from yattag import Doc
\end{verbatim}

\item html page generation
\label{sec:org6135e12}
\begin{enumerate}
\item functions definition
\label{sec:org26bd76f}
\begin{verbatim}
def linksgen(filename_base, pagenum, url):
    doc, tag, text = Doc().tagtext()

    with tag("div"):
	with tag('a', href = "."):
	    text('Home page')
	with tag("div"):
	    with tag("a", href = filename_base + str(pagenum - 1) + ".html"):
		text("Previous page")
	    text(" ")
	    with tag("a", href = filename_base + str(pagenum + 1) + ".html"):
		text("Next page")
	with tag("a", href = url, target="_blank"):
	    text("Original page")

    return doc.getvalue()


def pagegen(filename_base, pagenum, title, desc, company, days, url):
    doc, tag, text = Doc().tagtext()

    doc.asis('<meta charset="UTF-8">')
    with tag("title"):
	text(title)
    with tag("body"):
	doc.asis(linksgen(filename_base, pagenum, url))
	with tag("h1"):
	    text(title)
	with tag("h2"):
	    text(company)
	with tag("p"):
	    text(str(days) + " days ago")
	with tag("div"):
	    doc.asis(desc)
	doc.asis(linksgen(filename_base, pagenum, url))

    return doc.getvalue()
\end{verbatim}

\item test pagegen\hfill{}\textsc{test}
\label{sec:org0f00d9b}
\begin{verbatim}
pagegen("nom", 0, "titre", "desc", "firm", "days", "www")
\end{verbatim}

\item test linksgen\hfill{}\textsc{test}
\label{sec:org9617706}
\begin{verbatim}
linksgen("file", 10, "wwwww")
\end{verbatim}
\end{enumerate}
\item htmlexport function
\label{sec:org6aa6727}
\begin{enumerate}
\item definition
\label{sec:org40b5f0d}
\begin{verbatim}
def htmlexport(df, begin, end):
    date = str(datetime.now())
    path = "../reports/html/" + date + "/"
    mkdir(path)
    for i in range(begin, end):
	filename_base = "job-"
	html = pagegen(filename_base,
		       i,
		       df.title.iloc[i],
		       df.desc.iloc[i],
		       df.company.iloc[i],
		       df.days_ago.iloc[i],
		       df.url.iloc[i]
	)
	filename = path + filename_base +  str(i) + ".html"
	with open(filename, "a") as file:
	    file.write(html)

\end{verbatim}

\item call
\label{sec:orgdcf7a2c}
\begin{verbatim}
htmlexport(df_print, 0, 40)
\end{verbatim}

\item link
\label{sec:org2f6ff40}
\url{home/teddd/data/projects/jobseeker/reports/html/}
\end{enumerate}
\end{enumerate}
\end{enumerate}
\subsubsection{server}
\label{sec:org9de03f6}
\begin{enumerate}
\item flask ? :D !!!
\label{sec:org178132b}
\end{enumerate}
\subsubsection{org  table (python)\hfill{}\textsc{python}}
\label{sec:org58e4d72}
\begin{enumerate}
\item john kitchin example\hfill{}\textsc{test}
\label{sec:orgd508bfb}
\begin{verbatim}
import pandas as pd
test = pd.DataFrame({'A': [1000, 1000], 'B' : [60, 100]})
test2 = [list(test)] + [None] + test.values.tolist()
test3 = test.values.tolist()
return (test, test2, test3)
\end{verbatim}

\item my program\hfill{}\textsc{slow}
\label{sec:org726a17e}
\begin{verbatim}
import pandas as pd
df = pd.read_csv(data)
return  [list(df)] + [None] + df.values.tolist()
\end{verbatim}
\end{enumerate}

\subsubsection{org results: html\hfill{}\textsc{test}}
\label{sec:orgb19781b}
\begin{verbatim}
dfk.desc.iloc[0]
\end{verbatim}

\subsubsection{soupprint}
\label{sec:org06808a9}
\begin{enumerate}
\item session functions
\label{sec:org5b46a82}
\begin{enumerate}
\item souper (using get text)
\label{sec:orgf425760}
\begin{verbatim}
from bs4 import BeautifulSoup

def souper(html):
    "returns only the text from a html string"
    soup = BeautifulSoup(html, 'html.parser')
    return soup.get_text()
\end{verbatim}
\item soupprint
\label{sec:org649a126}
\begin{enumerate}
\item definition
\label{sec:org77bdd10}
\begin{verbatim}
from bs4 import BeautifulSoup

def souper(html):
    soup = BeautifulSoup(html, 'html.parser')
    print(soup.get_text())

def soupprint(df, begin, end):
    for i in range(begin, end):
	print(i, df.title.iloc[i])
	print("\n")
	print(df.company.iloc[i])
	print("\n")
	souper(df.desc.iloc[i])
	print("\n"*3)
	print("-"*100)
	print("\n"*3)
\end{verbatim}
\item call
\label{sec:orgd70f969}
\begin{verbatim}
soupprint(df, 0, 10)
\end{verbatim}
\end{enumerate}
\end{enumerate}

\item soupprint as org function
\label{sec:org8118ff7}
\begin{enumerate}
\item definition
\label{sec:org4958f80}
\begin{verbatim}
from bs4 import BeautifulSoup

def souper(html):
    soup = BeautifulSoup(html, 'html.parser')
    print(soup.get_text())

def soupprint(df, begin, end):
    for i in range(begin, end):
	print(i, df.title.iloc[i])
	print("\n")
	print(df.company.iloc[i])
	print("\n")
	souper(df.desc.iloc[i])
	print("\n"*3)
	print("-"*100)
	print("\n"*3)
\end{verbatim}

\item call
\label{sec:org8a57ec2}
\begin{verbatim}
soupprint(dfk, 0, dfk.title.count())
\end{verbatim}
\end{enumerate}
\end{enumerate}
\section{Documentation}
\label{sec:org48ee3c9}
\subsection{doc : look for matching patern\hfill{}\textsc{doc}}
\label{sec:org4628bc7}
\begin{verbatim}
help(df.title.str.contains)
\end{verbatim}

\subsection{pandas}
\label{sec:org20ab6dc}
\href{file:///home/teddd/Cours/Data/cheat-sheets/Pandas\_Cheat\_Sheet.pdf}{Pandas cheat sheet}
\section{Tests}
\label{sec:org8848e0e}
\subsection{ob-ipython}
\label{sec:org4c5a0a0}
\subsubsection{hands-on tryout}
\label{sec:orgf099a8f}
\begin{enumerate}
\item hello world
\label{sec:org2a634eb}
\begin{verbatim}
print 'hello world'
\end{verbatim}
\item function definition
\label{sec:orgbd6308f}
\begin{verbatim}
def fn():
    print "I am in the session !"
\end{verbatim}

\item function call
\label{sec:org8672a1a}
\begin{verbatim}
fn()
\end{verbatim}
\end{enumerate}

\subsubsection{doc tutorial}
\label{sec:org7740034}
\begin{enumerate}
\item imports
\label{sec:orgcf399d4}
\begin{verbatim}
%matplotlib inline
import matplotlib.pyplot as plt
import numpy as np
\end{verbatim}

\item ex2
\label{sec:org32b4f01}
\begin{verbatim}
def foo(x):
    return x + 9

[foo(x) + 7 for x in range(7)]
\end{verbatim}

\item images
\label{sec:org638ba17}
\begin{enumerate}
\item ex1
\label{sec:org989986a}
\begin{verbatim}
plt.hist(np.random.randn(20000), bins=200)
\end{verbatim}

\item ex2
\label{sec:org3b79fe8}
\begin{verbatim}
plt.hist(np.random.randn(20000), bins=200)
\end{verbatim}

\item config
\label{sec:org6c15e48}
\begin{verbatim}
%config InlineBackend.figure_format = 'svg'
\end{verbatim}
\end{enumerate}

\item other kernel
\label{sec:orgdcdb3e0}
\begin{verbatim}
(+ 1 2)
\end{verbatim}

\item async
\label{sec:orge40ab31}
\begin{verbatim}
import time
time.sleep(3)
plt.hist(np.random.randn(20000), bins=200)
\end{verbatim}
\end{enumerate}

\subsubsection{other tryouts}
\label{sec:orga8c34d4}
\begin{enumerate}
\item functions
\label{sec:org28a6d80}
\begin{enumerate}
\item call
\label{sec:orgda357e4}
\begin{verbatim}
lol()
\end{verbatim}
\end{enumerate}

\item formater
\label{sec:orgc80394b}
\begin{enumerate}
\item init
\label{sec:org0003edb}
\begin{verbatim}
import IPython
from tabulate import tabulate

class OrgFormatter(IPython.core.formatters.BaseFormatter):
    def __call__(self, obj):
	try:
	    return tabulate(obj, headers='keys',
			    tablefmt='orgtbl', showindex='always')
	except:
	    return None

ip = get_ipython()
ip.display_formatter.formatters['text/org'] = OrgFormatter()
\end{verbatim}
\item arrays
\label{sec:orgd14c4d5}
\end{enumerate}

\item kernel tests
\label{sec:org51fde7b}
\begin{enumerate}
\item session header arg after run console
\label{sec:org54d6587}
\begin{verbatim}
print("hello")
\end{verbatim}
\item kernel headerarg
\label{sec:org90ab166}
\begin{verbatim}
print("hello")
\end{verbatim}
\end{enumerate}
\end{enumerate}
\subsection{nltk}
\label{sec:org57492c4}
\subsubsection{text selection}
\label{sec:org67a5e09}
\begin{enumerate}
\item sample text base
\label{sec:org590abb9}
\begin{verbatim}
from nltk.book import *
\end{verbatim}
\item access text as string
\label{sec:orgff3ded8}
\begin{enumerate}
\item imports
\label{sec:orgae1a4ed}
\begin{verbatim}
import nltk, re, pprint
from nltk import word_tokenize
\end{verbatim}
\item with one description
\label{sec:org71ed3f2}
\begin{enumerate}
\item definition
\label{sec:org91ad4c8}
\begin{verbatim}
string = df.iloc[0].desc
\end{verbatim}

\item formating
\label{sec:orgaba2352}
\begin{enumerate}
\item html
\label{sec:orge6ac652}
\begin{verbatim}
string = souper(string)
\end{verbatim}

\item case
\label{sec:org71bf074}
\begin{verbatim}
string = string.lower()
\end{verbatim}

\item punctiations
\label{sec:org0dc4c74}

\begin{enumerate}
\item definition
\label{sec:org2c8e359}
\begin{verbatim}
def multi_replace(string, *args, replace=" "):
    for target in args:
	string = string.replace(target, replace)
    return string

trash_car = (",", "\'", "\"", "&", "#", "{", "}",
	     "(", ")", "[", "]", "_", "\\", "~", "-",
	     ",", ";", ":", ".", "?", "!", "+", "|",
	     "@", "/", "–", "*", "“", "„", "%", " ",
	     "€")

\end{verbatim}

\item call
\label{sec:orga58ab04}
\begin{verbatim}
string = multi_replace(string, *trash_car)
\end{verbatim}
\end{enumerate}
\end{enumerate}
\end{enumerate}


\item to ntlk text object
\label{sec:org50f8e28}
\begin{enumerate}
\item tokenizing
\label{sec:org641ee87}
\begin{verbatim}
tokens = word_tokenize(string)
\end{verbatim}

\item use as nltk text
\label{sec:org083024c}
\begin{verbatim}
text = nltk.Text(tokens)
\end{verbatim}
\end{enumerate}
\end{enumerate}
\end{enumerate}
\subsubsection{search}
\label{sec:orgb650981}
\begin{enumerate}
\item concordance
\label{sec:org3a0731b}
\begin{verbatim}
text.concordance("data")
\end{verbatim}
\item similar word
\label{sec:orgcb9bbce}
\begin{verbatim}
text.similar("analyst")
\end{verbatim}
\item dispersion
\label{sec:org120e34a}
\begin{verbatim}
text.dispersion_plot(["up", "with", "in", "the", "for", "team"])
\end{verbatim}
\end{enumerate}
\subsubsection{generation\hfill{}\textsc{test}}
\label{sec:org5bab624}
\begin{verbatim}
text.generate(["The", "job", "is", "for", "data", "team"])
\end{verbatim}

\subsubsection{normalizing}
\label{sec:org2a2c376}
\begin{enumerate}
\item steaming
\label{sec:org283f545}
\item lemmatization
\label{sec:org029bcff}
\end{enumerate}
\subsubsection{vocabulary}
\label{sec:orgdee898a}
\begin{enumerate}
\item sorted set
\label{sec:orgb126daa}
\begin{verbatim}
sorted(set(text))
\end{verbatim}
\item lexical richness
\label{sec:org68ddc83}
\begin{enumerate}
\item tryout
\label{sec:orgddfd8b8}
\begin{verbatim}
len(text) / len(set(text))
\end{verbatim}

\item function
\label{sec:org63d231c}
\begin{verbatim}
def lexical_diversity(text):
    return len(text) / len(set(text))
\end{verbatim}
\end{enumerate}
\item specific word
\label{sec:org905ec00}
\begin{enumerate}
\item tryout
\label{sec:org750d4ac}
\begin{verbatim}
100 * text.count('for') / len(text)
\end{verbatim}
\item functyion
\label{sec:org003537e}
\begin{verbatim}
def word_percentage(word):
    return 100 * text.count(word) / len(text)
\end{verbatim}
\end{enumerate}
\end{enumerate}

\subsubsection{{\bfseries\sffamily TODO} Build a corpus !}
\label{sec:orgd6c1245}

\begin{enumerate}
\item sklearn
\label{sec:orgba20ed4}
\begin{verbatim}
docs = df['desc']

tfs = tfidf.fit_transform(docs)
\end{verbatim}
\end{enumerate}
\end{document}
